<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuraci√≥n del Player Video.js - StreamingApp</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5rem;
        }
        
        .header p {
            margin: 0.5rem 0 0 0;
            opacity: 0.9;
        }
        
        .section {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .section h2 {
            color: #667eea;
            border-bottom: 2px solid #667eea;
            padding-bottom: 0.5rem;
            margin-top: 0;
        }
        
        .section h3 {
            color: #764ba2;
            margin-top: 1.5rem;
        }
        
        .config-block {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .config-block h4 {
            margin-top: 0;
            color: #495057;
        }
        
        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.9rem;
        }
        
        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .warning {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .feature-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 1rem;
        }
        
        .feature-card h4 {
            margin-top: 0;
            color: #495057;
        }
        
        .toc {
            background: #e9ecef;
            border-radius: 5px;
            padding: 1rem;
            margin-bottom: 2rem;
        }
        
        .toc ul {
            list-style: none;
            padding-left: 0;
        }
        
        .toc li {
            margin: 0.5rem 0;
        }
        
        .toc a {
            color: #667eea;
            text-decoration: none;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        .code-inline {
            background: #f1f3f4;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .plugin-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        
        .plugin-table th,
        .plugin-table td {
            border: 1px solid #dee2e6;
            padding: 0.75rem;
            text-align: left;
        }
        
        .plugin-table th {
            background: #f8f9fa;
            font-weight: 600;
        }
        
        .plugin-table tr:nth-child(even) {
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üé¨ Configuraci√≥n del Player Video.js</h1>
        <p>Documentaci√≥n completa del reproductor de video de StreamingApp</p>
    </div>

    <div class="toc">
        <h3>üìã √çndice de Contenidos</h3>
        <ul>
            <li><a href="#overview">1. Resumen General</a></li>
            <li><a href="#config">2. Configuraci√≥n Principal</a></li>
            <li><a href="#hls">3. Configuraci√≥n HLS/VHS</a></li>
            <li><a href="#controls">4. Controles y UI</a></li>
            <li><a href="#plugins">5. Plugins Integrados</a></li>
            <li><a href="#features">6. Caracter√≠sticas Avanzadas</a></li>
            <li><a href="#analytics">7. Analytics y M√©tricas</a></li>
            <li><a href="#troubleshooting">8. Soluci√≥n de Problemas</a></li>
        </ul>
    </div>

    <div class="section" id="overview">
        <h2>1. üìä Resumen General</h2>
        <p>Nuestro reproductor Video.js est√° optimizado para streaming HLS con las siguientes caracter√≠sticas principales:</p>
        
        <div class="feature-grid">
            <div class="feature-card">
                <h4>üéØ Streaming HLS</h4>
                <p>Reproducci√≥n adaptativa de calidad con soporte completo para HLS</p>
            </div>
            <div class="feature-card">
                <h4>üì± Responsive</h4>
                <p>Dise√±o fluido que se adapta a cualquier tama√±o de pantalla</p>
            </div>
            <div class="feature-card">
                <h4>‚ö° Optimizado</h4>
                <p>Configuraci√≥n de buffer y calidad optimizada para rendimiento</p>
            </div>
            <div class="feature-card">
                <h4>üéõÔ∏è Controles Avanzados</h4>
                <p>Hotkeys, skip buttons, control de velocidad y m√°s</p>
            </div>
        </div>

        <div class="highlight">
            <strong>üìç Ubicaci√≥n:</strong> <code>/frontend/app/src/Pages/VideoPlayer/VideoPlayer.jsx</code>
        </div>
    </div>

    <div class="section" id="config">
        <h2>2. ‚öôÔ∏è Configuraci√≥n Principal</h2>
        
        <div class="config-block">
            <h4>Configuraci√≥n Base del Player</h4>
            <pre><code>const player = videojs(videoRef.current, {
  controls: true,              // Mostrar controles
  autoplay: true,              // Reproducci√≥n autom√°tica
  preload: "auto",             // Precarga autom√°tica
  fluid: true,                 // Dise√±o responsive
  playbackRates: [0.5, 1, 1.25, 1.5, 2],  // Control de velocidad
  sources: [{
    src: urlComplete,          // URL del stream HLS
    type: "application/x-mpegURL"
  }],
  // ... configuraciones adicionales
});</code></pre>
        </div>

        <h3>üîß Opciones Principales</h3>
        <table class="plugin-table">
            <thead>
                <tr>
                    <th>Opci√≥n</th>
                    <th>Valor</th>
                    <th>Descripci√≥n</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>controls</code></td>
                    <td>true</td>
                    <td>Muestra los controles del player</td>
                </tr>
                <tr>
                    <td><code>autoplay</code></td>
                    <td>true</td>
                    <td>Inicia reproducci√≥n autom√°ticamente</td>
                </tr>
                <tr>
                    <td><code>preload</code></td>
                    <td>"auto"</td>
                    <td>Precarga el video autom√°ticamente</td>
                </tr>
                <tr>
                    <td><code>fluid</code></td>
                    <td>true</td>
                    <td>Hace el player responsive</td>
                </tr>
                <tr>
                    <td><code>playbackRates</code></td>
                    <td>[0.5, 1, 1.25, 1.5, 2]</td>
                    <td>Velocidades de reproducci√≥n disponibles</td>
                </tr>
                <tr>
                    <td><code>pip</code></td>
                    <td>true</td>
                    <td>Habilita Picture-in-Picture</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="section" id="hls">
        <h2>3. üé• Configuraci√≥n HLS/VHS</h2>
        
        <div class="config-block">
            <h4>Configuraci√≥n Optimizada para Streaming</h4>
            <pre><code>html5: {
  vhs: {
    overrideNative: true,                    // Control total sobre HLS
    enableLowInitialPlaylist: true,          // Mejora tiempo de inicio
    limitRenditionByPlayerDimensions: true,  // Optimiza ancho de banda
    useDevicePixelRatio: true,              // Mejor calidad en pantallas HD
    fastQualityChange: true,                // Cambios r√°pidos de calidad
    smoothQualityChange: true,              // Transiciones suaves
    maxPlaylistRetries: 3,                  // Reintentos en caso de error
    bandwidth: 4194304,                     // Ancho de banda m√°ximo (4 Mbps)
    initialBandwidth: 2000000,              // Ancho de banda inicial (2 Mbps)
    allowSeeksWithinUnsafeLiveWindow: true, // Mejor seeking en live
    playlistExclusionDuration: 60,          // Tiempo de exclusi√≥n de playlist
    maxBufferLength: 30                     // Buffer m√°ximo (30 segundos)
  },
  nativeControlsForTouch: false,            // Controles consistentes
  playsinline: true,                        // Reproducci√≥n inline en m√≥viles
  nativeTextTracks: false,                  // Control manual de subt√≠tulos
  preloadTextTracks: true                   // Precarga de subt√≠tulos
}</code></pre>
        </div>

        <h3>üéõÔ∏è Explicaci√≥n de Configuraciones VHS</h3>
        
        <div class="config-block">
            <h4>üöÄ Optimizaciones de Rendimiento</h4>
            <ul>
                <li><strong>enableLowInitialPlaylist:</strong> Reduce el tiempo de inicio cargando una playlist inicial m√°s peque√±a</li>
                <li><strong>limitRenditionByPlayerDimensions:</strong> Evita descargar calidades superiores al tama√±o del player</li>
                <li><strong>fastQualityChange:</strong> Permite cambios r√°pidos de calidad sin rebuffering</li>
                <li><strong>initialBandwidth:</strong> Inicia con una estimaci√≥n conservadora (2 Mbps) para startups m√°s r√°pidos</li>
            </ul>
        </div>

        <div class="config-block">
            <h4>üì° Configuraciones de Red</h4>
            <ul>
                <li><strong>maxPlaylistRetries:</strong> Reintenta hasta 3 veces en caso de error de red</li>
                <li><strong>playlistExclusionDuration:</strong> Excluye playlists problem√°ticas por 60 segundos</li>
                <li><strong>maxBufferLength:</strong> Mantiene hasta 30 segundos de buffer para reproducci√≥n fluida</li>
            </ul>
        </div>
    </div>

    <div class="section" id="controls">
        <h2>4. üéÆ Controles y UI</h2>
        
        <div class="config-block">
            <h4>Barra de Controles Personalizada</h4>
            <pre><code>controlBar: {
  children: [
    "playToggle",              // Bot√≥n play/pausa
    "skipButtons",             // Botones de skip
    "volumePanel",             // Control de volumen
    "currentTimeDisplay",      // Tiempo actual
    "timeDivider",            // Separador de tiempo
    "durationDisplay",         // Duraci√≥n total
    "progressControl",         // Barra de progreso
    "remainingTimeDisplay",    // Tiempo restante
    "playbackRateMenuButton",  // Control de velocidad
    "audioTrackButton",        // Pistas de audio
    "subsCapsButton",          // Subt√≠tulos
    "pictureInPictureToggle",  // Picture-in-Picture
    "fullscreenToggle"         // Pantalla completa
  ],
  skipButtons: {
    backward: 10,              // Skip atr√°s 10 segundos
    forward: 10                // Skip adelante 10 segundos
  }
}</code></pre>
        </div>

        <h3>‚å®Ô∏è Hotkeys Configurados</h3>
        
        <div class="feature-grid">
            <div class="feature-card">
                <h4>üé¨ Controles B√°sicos</h4>
                <ul>
                    <li><strong>Espacio:</strong> Play/Pausa</li>
                    <li><strong>‚Üê ‚Üí:</strong> Skip 10s atr√°s/adelante</li>
                    <li><strong>J / L:</strong> Skip 10s atr√°s/adelante</li>
                    <li><strong>F:</strong> Pantalla completa</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>üîä Configuraci√≥n de Audio</h4>
                <ul>
                    <li><strong>volumeStep:</strong> 0.1 (10% por paso)</li>
                    <li><strong>enableVolumeScroll:</strong> false</li>
                    <li><strong>enableHoverScroll:</strong> false</li>
                </ul>
            </div>
        </div>

        <div class="warning">
            <strong>‚ö†Ô∏è Limitaci√≥n de Subt√≠tulos:</strong> Los subt√≠tulos externos (.vtt) NO se sincronizan autom√°ticamente con cambios de velocidad. Esto es una limitaci√≥n conocida de Video.js.
        </div>
    </div>

    <div class="section" id="plugins">
        <h2>5. üîå Plugins Integrados</h2>
        
        <table class="plugin-table">
            <thead>
                <tr>
                    <th>Plugin</th>
                    <th>Versi√≥n</th>
                    <th>Funci√≥n</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>videojs-contrib-quality-levels</code></td>
                    <td>Oficial</td>
                    <td>Exposici√≥n de niveles de calidad disponibles</td>
                </tr>
                <tr>
                    <td><code>jb-videojs-hls-quality-selector</code></td>
                    <td>Comunidad</td>
                    <td>Selector manual de calidad en la UI</td>
                </tr>
                <tr>
                    <td><code>videojs-overlay</code></td>
                    <td>Oficial</td>
                    <td>Sistema de overlays personalizados</td>
                </tr>
                <tr>
                    <td><code>videojs-hotkeys</code></td>
                    <td>Comunidad</td>
                    <td>Soporte para atajos de teclado</td>
                </tr>
            </tbody>
        </table>

        <h3>üéØ Configuraci√≥n de Plugins</h3>
        
        <div class="config-block">
            <h4>Quality Selector</h4>
            <pre><code>// Configuraci√≥n del selector de calidad
if (player.hlsQualitySelector) {
  player.hlsQualitySelector({
    displayCurrentQuality: true,  // Muestra la calidad actual
  });
}</code></pre>
        </div>

        <div class="config-block">
            <h4>Overlay System</h4>
            <pre><code>// Configuraci√≥n del sistema de overlays
player.overlay({
  overlays: [{
    content: overlayContainer,    // Contenedor del overlay
    start: 0,                    // Inicio del overlay
    end: 'end'                   // Fin del overlay
  }]
});</code></pre>
        </div>
    </div>

    <div class="section" id="features">
        <h2>6. üåü Caracter√≠sticas Avanzadas</h2>
        
        <h3>üíæ Persistencia de Preferencias</h3>
        <div class="config-block">
            <h4>Datos Guardados Autom√°ticamente</h4>
            <ul>
                <li><strong>Volumen:</strong> Nivel de volumen del usuario</li>
                <li><strong>Subt√≠tulos:</strong> Idioma y configuraci√≥n seleccionada</li>
                <li><strong>Velocidad:</strong> Velocidad de reproducci√≥n preferida</li>
                <li><strong>Posici√≥n:</strong> √öltimo punto de reproducci√≥n por contenido</li>
            </ul>
        </div>

        <h3>üîÑ Manejo de Errores</h3>
        <div class="config-block">
            <h4>Sistema de Recuperaci√≥n Autom√°tica</h4>
            <pre><code>// Configuraci√≥n de reintentos
let retryCount = 0;
const maxRetries = 3;

player.on('error', () => {
  const error = player.error();
  
  if (error && error.code === 2 && retryCount < maxRetries) {
    retryCount++;
    console.log(`üîÑ Reintentando conexi√≥n (${retryCount}/${maxRetries})...`);
    
    setTimeout(() => {
      player.src({ src: urlComplete, type: 'application/x-mpegURL' });
      player.load();
    }, 3000);
  }
});</code></pre>
        </div>

        <h3>üì± Pantalla Completa Autom√°tica</h3>
        <div class="config-block">
            <h4>Activaci√≥n Autom√°tica</h4>
            <pre><code>player.ready(() => {
  player.one('canplay', () => {
    if (player.requestFullscreen) {
      player.requestFullscreen()
        .then(() => console.log('‚úÖ Pantalla completa activada'))
        .catch(err => console.warn('‚ö†Ô∏è No se pudo activar:', err));
    }
  });
});</code></pre>
        </div>
    </div>

    <div class="section" id="analytics">
        <h2>7. üìä Analytics y M√©tricas</h2>
        
        <div class="config-block">
            <h4>M√©tricas Recolectadas</h4>
            <pre><code>analyticsRef.current = {
  watchTime: 0,              // Tiempo total visto
  lastTime: 0,               // √öltimo timestamp
  rebufferCount: 0,          // N√∫mero de rebuffers
  qualityChanges: 0,         // Cambios de calidad
  sessionStartTime: Date.now() // Inicio de sesi√≥n
};</code></pre>
        </div>

        <h3>üìà Eventos Monitoreados</h3>
        <div class="feature-grid">
            <div class="feature-card">
                <h4>‚è±Ô∏è Tiempo de Reproducci√≥n</h4>
                <ul>
                    <li>Tiempo total visualizado</li>
                    <li>Duraci√≥n de sesi√≥n</li>
                    <li>Tasa de completado</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>üé≠ Calidad de Experiencia</h4>
                <ul>
                    <li>N√∫mero de rebuffers</li>
                    <li>Cambios de calidad</li>
                    <li>Tiempo de startup</li>
                </ul>
            </div>
        </div>

        <div class="highlight">
            <strong>üí° Tip:</strong> Para analytics profesionales, considera integrar <code>videojs-mux</code> (costo: $0.005 por hora vista).
        </div>
    </div>

    <div class="section" id="troubleshooting">
        <h2>8. üîß Soluci√≥n de Problemas</h2>
        
        <h3>‚ùå Problemas Comunes</h3>
        
        <div class="config-block">
            <h4>1. Subt√≠tulos Desincronizados</h4>
            <div class="warning">
                <strong>Problema:</strong> Los subt√≠tulos no se sincronizan con cambios de velocidad.<br>
                <strong>Causa:</strong> Limitaci√≥n conocida de Video.js con subt√≠tulos externos.<br>
                <strong>Soluci√≥n:</strong> Embeber subt√≠tulos en el stream HLS o aceptar la limitaci√≥n.
            </div>
        </div>

        <div class="config-block">
            <h4>2. Problemas de Carga</h4>
            <div class="warning">
                <strong>Problema:</strong> Video no carga o errores de red.<br>
                <strong>Soluci√≥n:</strong> Sistema de reintentos autom√°ticos configurado (3 intentos).
            </div>
        </div>

        <div class="config-block">
            <h4>3. Problemas de Calidad</h4>
            <div class="warning">
                <strong>Problema:</strong> Calidad no cambia autom√°ticamente.<br>
                <strong>Soluci√≥n:</strong> Verificar configuraci√≥n VHS y conexi√≥n de red.
            </div>
        </div>

        <h3>üîç Debugging</h3>
        <div class="config-block">
            <h4>Logs Disponibles</h4>
            <pre><code>// Logs de configuraci√≥n
console.log('üé¨ Metadata cargada, configurando...');
console.log('üì∫ Calidad activa:', quality);
console.log('üé¨ Skip backward 10s:', currentTime);
console.log('üìä Analytics - Video completado:', metrics);</code></pre>
        </div>

        <div class="success">
            <strong>‚úÖ Estado √ìptimo:</strong> Tu configuraci√≥n actual est√° optimizada seg√∫n las mejores pr√°cticas de Video.js. Los cambios recientes (playbackRates e initialBandwidth) mejoran la experiencia de usuario.
        </div>
    </div>

    <div class="section">
        <h2>üìù Notas Finales</h2>
        <p>Esta documentaci√≥n cubre la configuraci√≥n completa del reproductor Video.js implementado en StreamingApp. El player est√° optimizado para:</p>
        <ul>
            <li>‚úÖ Streaming HLS adaptativo</li>
            <li>‚úÖ Experiencia de usuario fluida</li>
            <li>‚úÖ Compatibilidad cross-browser</li>
            <li>‚úÖ Caracter√≠sticas avanzadas (hotkeys, overlays, analytics)</li>
        </ul>
        
        <div class="highlight">
            <strong>üîÑ √öltima actualizaci√≥n:</strong> Enero 2025<br>
            <strong>üìç Archivo:</strong> <code>frontend/app/src/Pages/VideoPlayer/VideoPlayer.jsx</code><br>
            <strong>üë®‚Äçüíª Mantenedor:</strong> Equipo StreamingApp
        </div>
    </div>
</body>
</html>