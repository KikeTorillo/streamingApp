/* ===== UNIVERSAL IMAGE COMPONENT - 100% REUTILIZABLE ===== */
/* UniversalImage.css - Sistema universal sin acoplamientos */

/* ===== CONTENEDOR BASE ===== */
.universal-image {
  position: relative;
  display: block;
  width: 100%;
  overflow: hidden;
  background-color: var(--bg-muted);
  
  /* Patrón de fondo universal para indicar carga */
  background-image: linear-gradient(
    45deg,
    var(--bg-muted) 25%,
    transparent 25%,
    transparent 75%,
    var(--bg-muted) 75%
  );
  background-size: 2rem 2rem;
  
  /* Transiciones suaves */
  transition: all var(--transition-normal);
  
  /* Border radius por defecto */
  border-radius: var(--radius-md);
}

/* ===== TAMAÑOS UNIVERSALES - FLEX RESPONSIVE ===== */
.universal-image--size-xs,
.universal-image--size-sm,
.universal-image--size-md,
.universal-image--size-lg,
.universal-image--size-xl {
  width: 100%; /* ✅ FIX: Siempre usar 100% del contenedor padre */
  height: 100%; /* ✅ FIX: Siempre usar 100% del contenedor padre */
  min-height: 0; /* ✅ FIX: Eliminar restricciones de altura mínima */
}

.universal-image--size-full {
  width: 100%;
  height: 100%;
  min-height: 0;
}

/* ===== VARIANTES UNIVERSALES ===== */
.universal-image--variant-primary {
  border: 0.1rem solid var(--color-primary-subtle, transparent);
}

.universal-image--variant-secondary {
  border: 0.1rem solid var(--color-secondary-subtle, transparent);
}

.universal-image--variant-success {
  border: 0.1rem solid var(--color-success-subtle, transparent);
}

.universal-image--variant-warning {
  border: 0.1rem solid var(--color-warning-subtle, transparent);
}

.universal-image--variant-danger {
  border: 0.1rem solid var(--color-danger-subtle, transparent);
}

.universal-image--variant-neutral {
  border: 0.1rem solid var(--color-neutral-subtle, transparent);
}

/* ===== ASPECT RATIOS UNIVERSALES ===== */
.universal-image--aspect-square {
  aspect-ratio: 1/1; /* Avatares, logos, iconos */
}

.universal-image--aspect-portrait {
  aspect-ratio: 2/3; /* Productos, posters, libros */
}

.universal-image--aspect-landscape {
  aspect-ratio: 3/2; /* Fotos, paisajes */
}

.universal-image--aspect-wide {
  aspect-ratio: 16/9; /* Videos, banners, hero */
}

.universal-image--aspect-ultrawide {
  aspect-ratio: 21/9; /* Banners promocionales */
}

.universal-image--aspect-golden {
  aspect-ratio: 1.618/1; /* Proporción áurea */
}

.universal-image--aspect-card {
  aspect-ratio: 5/7; /* Tarjetas tradicionales */
}

.universal-image--aspect-mobile {
  aspect-ratio: 9/16; /* Móvil vertical */
}

/* Aspect ratios personalizados usando CSS custom properties */
.universal-image[style*="aspect-ratio"] {
  aspect-ratio: var(--card-aspect-ratio, 2/3);
}

/* ===== BORDER RADIUS ===== */
.universal-image--rounded-sm {
  border-radius: var(--radius-sm);
}

.universal-image--rounded-lg {
  border-radius: var(--radius-lg);
}

.universal-image--rounded-xl {
  border-radius: var(--radius-xl);
}

.universal-image--rounded-full {
  border-radius: var(--radius-full);
  overflow: hidden;
}

/* ===== IMAGEN PRINCIPAL ===== */
.universal-image__img {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: block;
  transition: all var(--transition-normal);
  
  /* Prevenir selección y arrastre */
  user-select: none;
  -webkit-user-drag: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
}

/* ===== OBJECT FIT UNIVERSALES ===== */
.universal-image--object-fit-cover .universal-image__img {
  object-fit: cover;
}

.universal-image--object-fit-contain .universal-image__img {
  object-fit: contain;
}

.universal-image--object-fit-fill .universal-image__img {
  object-fit: fill;
}

.universal-image--object-fit-scale-down .universal-image__img {
  object-fit: scale-down;
}

.universal-image--object-fit-none .universal-image__img {
  object-fit: none;
}

/* ===== SKELETON DE CARGA UNIVERSAL ===== */
.universal-image__skeleton {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  background: linear-gradient(
    90deg,
    var(--bg-muted) 25%,
    var(--bg-secondary) 50%,
    var(--bg-muted) 75%
  );
  background-size: 200% 100%;
  animation: universalImageLoading 2s infinite;
  z-index: 1;
}

.universal-image__skeleton-icon {
  font-size: var(--card-icon-size, var(--font-size-2xl));
  margin-bottom: var(--space-sm);
  animation: universalImagePulse 2s infinite;
}

@keyframes universalImageLoading {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

@keyframes universalImagePulse {
  0%, 100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.6;
    transform: scale(1.1);
  }
}

/* ===== ESTADO DE ERROR ===== */
.universal-image__error-state {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  background-color: var(--bg-muted);
  color: var(--text-muted);
  z-index: 2;
}

.universal-image__error-icon {
  font-size: var(--font-size-xl);
  margin-bottom: var(--space-xs);
  color: var(--color-danger);
}

.universal-image__error-text {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  text-align: center;
  line-height: var(--line-height-tight);
}

/* ===== ESTADOS DE LOADING ===== */

/* Por defecto, las imágenes son visibles */
.universal-image__img {
  opacity: 1;
  transition: opacity var(--transition-normal);
}

/* Solo cuando está en estado de carga, ocultar imagen y mostrar skeleton */
.universal-image--loading .universal-image__img {
  opacity: 0;
}

.universal-image--loading .universal-image__skeleton {
  opacity: 1;
}

/* Por defecto, skeleton está oculto */
.universal-image__skeleton {
  opacity: 0;
}

/* Blur effect (para loading progresivo) */
.universal-image--blur .universal-image__img {
  filter: blur(0.5rem);
  transition: filter var(--transition-normal);
}

.universal-image--blur.universal-image--loaded .universal-image__img {
  filter: blur(0);
}

/* ===== ESTADOS DEL SISTEMA ===== */

/* Estado deshabilitado */
.universal-image--disabled {
  opacity: var(--opacity-disabled, 0.5);
  pointer-events: none;
  cursor: not-allowed;
}

.universal-image--disabled .universal-image__img {
  filter: grayscale(100%) opacity(0.7);
}

.universal-image__disabled-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.3);
  z-index: 3;
}

/* Estado de loading del sistema */
.universal-image--system-loading {
  position: relative;
}

.universal-image--system-loading::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 2rem;
  height: 2rem;
  margin: -1rem 0 0 -1rem;
  border: 0.2rem solid var(--color-primary-subtle);
  border-top: 0.2rem solid var(--color-primary);
  border-radius: 50%;
  animation: universalImageSpinner 1s linear infinite;
  z-index: 3;
}

@keyframes universalImageSpinner {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* ===== HOVER EFFECTS ===== */
.universal-image:hover .universal-image__img {
  transform: scale(1.02);
}

/* ===== FALLBACK IMAGE ===== */
.universal-image__fallback {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: 1;
}

/* ===== RESPONSIVE DESIGN ===== */

/* Tablets */
@media (max-width: 768px) {
  .universal-image__skeleton-icon {
    font-size: var(--font-size-xl);
  }
  
  .universal-image__error-icon {
    font-size: var(--font-size-lg);
  }
  
  .universal-image__error-text {
    font-size: var(--font-size-xs);
  }
}

/* Móviles */
@media (max-width: 480px) {
  /* Deshabilitar hover effects en móviles */
  .universal-image:hover .universal-image__img {
    transform: none;
  }
  
  .universal-image__skeleton-icon {
    font-size: var(--font-size-lg);
  }
  
  .universal-image__error-icon {
    font-size: var(--font-size-base);
  }
  
  /* Patrón de fondo más pequeño en móviles */
  .universal-image {
    background-size: 1.5rem 1.5rem;
  }
}

/* ===== MODO OSCURO ===== */
.dark .universal-image {
  background-color: var(--bg-muted);
}

.dark .universal-image__skeleton {
  background: linear-gradient(
    90deg,
    var(--bg-muted) 25%,
    var(--bg-secondary) 50%,
    var(--bg-muted) 75%
  );
}

.dark .universal-image__error-state {
  background-color: var(--bg-muted);
}

/* ===== ACCESIBILIDAD ===== */

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .universal-image,
  .universal-image__img,
  .universal-image__skeleton-icon {
    transition: none;
    animation: none;
  }
  
  .universal-image:hover .universal-image__img {
    transform: none;
  }
  
  .universal-image__skeleton {
    background: var(--bg-muted);
  }
}

/* High contrast */
@media (prefers-contrast: high) {
  .universal-image {
    border: 0.1rem solid var(--text-primary);
  }
  
  .universal-image__error-state {
    border: 0.2rem solid var(--color-danger);
    background-color: var(--bg-primary);
  }
  
  .universal-image__error-text {
    color: var(--text-primary);
    font-weight: var(--font-weight-bold);
  }
}

/* ===== UTILIDADES ===== */

/* Para imágenes circulares */
.universal-image--rounded-full .universal-image__img,
.universal-image--rounded-full .universal-image__fallback {
  border-radius: inherit;
}

/* Para imágenes con overlay de contenido */
.universal-image--overlay {
  position: relative;
}

.universal-image--overlay::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(
    to bottom,
    rgba(0, 0, 0, 0) 0%,
    rgba(0, 0, 0, 0.8) 100%
  );
  pointer-events: none;
  opacity: 0;
  transition: opacity var(--transition-normal);
}

.universal-image--overlay:hover::after {
  opacity: 1;
}

/* ===== OPTIMIZACIONES ===== */

/* Mejorar rendering de imágenes */
.universal-image__img {
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
}

/* Prevenir layout shift durante carga */
.universal-image {
  contain: layout style paint;
}

/* Optimización para imágenes lazy */
.universal-image__img[loading="lazy"] {
  content-visibility: auto;
}