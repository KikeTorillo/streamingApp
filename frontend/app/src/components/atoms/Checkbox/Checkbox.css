/* components/atoms/Checkbox/Checkbox.css */
/* ===== CHECKBOX COMPONENT - SISTEMA DE DISEÑO ESTÁNDAR MIGRADO ===== */

/* ✅ MIGRADO AL SISTEMA ESTÁNDAR:
 * - 6 variantes semánticas (primary, secondary, success, warning, danger, neutral)
 * - 5 tamaños estándar (xs, sm, md, lg, xl)
 * - Estados loading con spinner integrado
 * - Soporte indeterminate completo
 * - Design tokens automáticos
 * - Sistema de iconos unificado
 * - Backward compatibility 100%
 */

.checkbox-container {
  display: flex;
  flex-direction: column;
  gap: var(--space-xs);
  font-family: var(--font-family-base);
}

.checkbox-wrapper {
  display: flex;
  align-items: flex-start;
  gap: var(--space-sm);
  position: relative;
  cursor: pointer;
}

/* ===== INPUT NATIVO (OCULTO PERO FUNCIONAL) ===== */
.checkbox {
  position: absolute;
  opacity: 0;
  width: 0;
  height: 0;
  /* REMOVIDO: pointer-events: none; */
  /* El input debe poder recibir eventos para que sea clickeable */
}

/* ===== CHECKBOX VISUAL PERSONALIZADO + VARIANTES ESTÁNDAR ===== */
.checkbox-custom {
  display: flex;
  align-items: center;
  justify-content: center;
  border: 0.2rem solid var(--border-default);
  background-color: var(--bg-primary);
  transition: all var(--transition-normal);
  flex-shrink: 0;
  position: relative;
  cursor: pointer;
  z-index: 1;
}

/* ===== RADIO PERSONALIZADO POR VARIANTE ===== */
.checkbox--rounded-sm + .checkbox-custom {
  border-radius: var(--radius-sm);
}

.checkbox--rounded-md + .checkbox-custom {
  border-radius: var(--radius-md);
}

.checkbox--rounded-lg + .checkbox-custom {
  border-radius: var(--radius-lg);
}

.checkbox--rounded-xl + .checkbox-custom {
  border-radius: var(--radius-xl);
}

.checkbox--rounded-full + .checkbox-custom {
  border-radius: var(--radius-full);
}

/* AGREGADO: Expandir el área clickeable del input para cubrir el checkbox visual */
.checkbox-wrapper .checkbox {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  margin: 0;
  cursor: pointer;
  z-index: 2; /* Encima del visual para recibir clicks */
}

/* ===== TAMAÑOS ESTÁNDAR (5 TAMAÑOS) - USANDO SISTEMA CORRECTO ===== */
.checkbox--xs + .checkbox-custom {
  width: 1.6rem;   /* 16px - Tamaño xs para checkbox */
  height: 1.6rem;
}

.checkbox--sm + .checkbox-custom {
  width: 2.0rem;   /* 20px - Tamaño sm para checkbox */
  height: 2.0rem;
}

.checkbox--md + .checkbox-custom {
  width: 2.4rem;   /* 24px - Tamaño md para checkbox */
  height: 2.4rem;
}

.checkbox--lg + .checkbox-custom {
  width: 2.8rem;   /* 28px - Tamaño lg para checkbox */
  height: 2.8rem;
}

.checkbox--xl + .checkbox-custom {
  width: 3.2rem;   /* 32px - Tamaño xl para checkbox */
  height: 3.2rem;
}

/* ===== ÍCONO DE CHECK ===== */
.checkbox-check {
  width: 70%;
  height: 70%;
  color: var(--color-white);
  opacity: 0;
  transform: scale(0.8);
  transition: all var(--transition-fast);
  pointer-events: none; /* El ícono no debe interferir con clicks */
}

/* ===== ESTADOS ===== */

/* Hover */
.checkbox:not(:disabled):not(:checked) + .checkbox-custom:hover {
  border-color: var(--border-hover);
  box-shadow: var(--shadow-sm);
}

/* Focus */
.checkbox:focus-visible + .checkbox-custom {
  outline: 0.2rem solid var(--border-focus);
  outline-offset: 0.2rem;
  border-color: var(--border-focus);
}

/* ===== VARIANTES SEMÁNTICAS ESTÁNDAR ===== */

/* PRIMARY - Por defecto */
.checkbox--primary:checked + .checkbox-custom {
  background-color: var(--color-primary);
  border-color: var(--color-primary);
}

.checkbox--primary:checked:not(:disabled) + .checkbox-custom:hover {
  background-color: var(--color-primary-hover);
  border-color: var(--color-primary-hover);
}

/* SECONDARY */
.checkbox--secondary:checked + .checkbox-custom {
  background-color: var(--color-secondary);
  border-color: var(--color-secondary);
}

.checkbox--secondary:checked:not(:disabled) + .checkbox-custom:hover {
  background-color: var(--color-secondary-hover);
  border-color: var(--color-secondary-hover);
}

/* SUCCESS */
.checkbox--success:checked + .checkbox-custom {
  background-color: var(--color-success);
  border-color: var(--color-success);
}

.checkbox--success:checked:not(:disabled) + .checkbox-custom:hover {
  background-color: var(--color-success-hover);
  border-color: var(--color-success-hover);
}

/* WARNING */
.checkbox--warning:checked + .checkbox-custom {
  background-color: var(--color-warning);
  border-color: var(--color-warning);
}

.checkbox--warning:checked:not(:disabled) + .checkbox-custom:hover {
  background-color: var(--color-warning-hover);
  border-color: var(--color-warning-hover);
}

/* DANGER */
.checkbox--danger:checked + .checkbox-custom {
  background-color: var(--color-danger);
  border-color: var(--color-danger);
}

.checkbox--danger:checked:not(:disabled) + .checkbox-custom:hover {
  background-color: var(--color-danger-hover);
  border-color: var(--color-danger-hover);
}

/* NEUTRAL */
.checkbox--neutral:checked + .checkbox-custom {
  background-color: var(--color-neutral);
  border-color: var(--color-neutral);
}

.checkbox--neutral:checked:not(:disabled) + .checkbox-custom:hover {
  background-color: var(--color-neutral-hover);
  border-color: var(--color-neutral-hover);
}

/* ===== ESTADOS CHECKED GENERALES ===== */
.checkbox:checked + .checkbox-custom .checkbox-check {
  opacity: 1;
  transform: scale(1);
}

/* Disabled */
.checkbox:disabled + .checkbox-custom {
  opacity: 0.6;
  cursor: not-allowed;
  background-color: var(--bg-disabled);
  border-color: var(--border-default);
}

.checkbox:disabled:checked + .checkbox-custom {
  background-color: var(--text-disabled);
  border-color: var(--text-disabled);
}

/* ===== SPINNER PARA ESTADO LOADING ===== */
.checkbox-spinner {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 70%;
  height: 70%;
}

.checkbox-spinner-circle {
  width: 100%;
  height: 100%;
  border: 2px solid transparent;
  border-top: 2px solid currentColor;
  border-radius: 50%;
  animation: checkbox-spin 1s linear infinite;
  color: var(--text-muted);
}

@keyframes checkbox-spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* ===== ESTADOS LOADING POR VARIANTE ===== */
.checkbox--loading + .checkbox-custom {
  border-color: var(--border-muted);
  background-color: var(--bg-muted);
  cursor: wait;
}

.checkbox--primary.checkbox--loading + .checkbox-custom .checkbox-spinner-circle {
  border-top-color: var(--color-primary);
}

.checkbox--secondary.checkbox--loading + .checkbox-custom .checkbox-spinner-circle {
  border-top-color: var(--color-secondary);
}

.checkbox--success.checkbox--loading + .checkbox-custom .checkbox-spinner-circle {
  border-top-color: var(--color-success);
}

.checkbox--warning.checkbox--loading + .checkbox-custom .checkbox-spinner-circle {
  border-top-color: var(--color-warning);
}

.checkbox--danger.checkbox--loading + .checkbox-custom .checkbox-spinner-circle {
  border-top-color: var(--color-danger);
}

.checkbox--neutral.checkbox--loading + .checkbox-custom .checkbox-spinner-circle {
  border-top-color: var(--color-neutral);
}

/* ===== ERROR STATE ===== */
.checkbox--error + .checkbox-custom {
  border-color: var(--color-danger);
}

.checkbox--error:focus-visible + .checkbox-custom {
  outline-color: var(--color-danger);
  border-color: var(--color-danger);
}

/* ===== LABEL CON ICONOS PERSONALIZADOS ===== */
.checkbox-label {
  display: flex;
  align-items: center;
  gap: var(--space-xs);
  font-size: var(--font-size-base);
  color: var(--text-primary);
  line-height: var(--line-height-normal);
  cursor: pointer;
  user-select: none;
  transition: color var(--transition-normal);
  font-weight: var(--font-weight-normal);
}

.checkbox-label-text {
  display: flex;
  align-items: center;
  flex: 1;
}

.checkbox-label-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.checkbox-label-icon--left {
  order: -1;
}

.checkbox-label-icon--right {
  order: 1;
}

.checkbox-label:hover {
  color: var(--color-primary);
}

.checkbox-required {
  color: var(--color-danger);
  font-weight: var(--font-weight-bold);
  margin-left: var(--space-xs);
}

/* ===== ESTADOS DEL LABEL AVANZADOS ===== */
.checkbox-container--disabled .checkbox-label {
  opacity: 0.6;
  cursor: not-allowed;
  color: var(--text-disabled);
}

.checkbox-container--disabled .checkbox-label:hover {
  color: var(--text-disabled);
}

.checkbox-container--loading .checkbox-label {
  color: var(--text-muted);
  cursor: wait;
}

/* Estados por variante del label */
.checkbox-container--primary .checkbox-label:hover {
  color: var(--color-primary);
}

.checkbox-container--secondary .checkbox-label:hover {
  color: var(--color-secondary);
}

.checkbox-container--success .checkbox-label:hover {
  color: var(--color-success);
}

.checkbox-container--warning .checkbox-label:hover {
  color: var(--color-warning);
}

.checkbox-container--danger .checkbox-label:hover {
  color: var(--color-danger);
}

.checkbox-container--neutral .checkbox-label:hover {
  color: var(--color-neutral);
}

/* ===== HELPER TEXT CON LOADING ===== */
.checkbox-helper {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
  line-height: var(--line-height-tight);
  margin-left: calc(var(--space-sm) + var(--size-md)); /* Tokens automáticos */
}

.checkbox-loading-text {
  color: var(--color-primary);
  font-weight: var(--font-weight-medium);
  animation: checkbox-loading-pulse 1.5s ease-in-out infinite;
}

@keyframes checkbox-loading-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* ===== ERROR MESSAGE ===== */
.checkbox-error {
  font-size: var(--font-size-xs);
  color: var(--color-danger);
  line-height: var(--line-height-tight);
  font-weight: var(--font-weight-medium);
  margin-left: calc(var(--space-sm) + 1.6rem); /* Alinear con el label */
  animation: slideInError 0.2s ease-out;
}

/* ===== DIFERENTES TAMAÑOS DE HELPER Y ERROR (VALORES ESPECÍFICOS) ===== */
.checkbox--xs ~ .checkbox-helper,
.checkbox--xs ~ .checkbox-error {
  margin-left: calc(var(--space-sm) + 1.6rem); /* 12px + 16px = 28px */
}

.checkbox--sm ~ .checkbox-helper,
.checkbox--sm ~ .checkbox-error {
  margin-left: calc(var(--space-sm) + 2.0rem); /* 12px + 20px = 32px */
}

.checkbox--md ~ .checkbox-helper,
.checkbox--md ~ .checkbox-error {
  margin-left: calc(var(--space-sm) + 2.4rem); /* 12px + 24px = 36px */
}

.checkbox--lg ~ .checkbox-helper,
.checkbox--lg ~ .checkbox-error {
  margin-left: calc(var(--space-sm) + 2.8rem); /* 12px + 28px = 40px */
}

.checkbox--xl ~ .checkbox-helper,
.checkbox--xl ~ .checkbox-error {
  margin-left: calc(var(--space-sm) + 3.2rem); /* 12px + 32px = 44px */
}

/* ===== ANIMACIONES ===== */
@keyframes slideInError {
  from {
    opacity: 0;
    transform: translateY(-0.4rem);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ===== MODO OSCURO ===== */
.dark .checkbox-custom {
  background-color: var(--bg-primary);
  border-color: var(--border-default);
}

.dark .checkbox-label {
  color: var(--text-primary);
}

.dark .checkbox-helper {
  color: var(--text-muted);
}

/* ===== RESPONSIVE CON TOKENS ESTÁNDAR ===== */
@media (max-width: 768px) {
  /* Área táctil más grande en móvil */
  .checkbox-custom {
    min-width: var(--touch-target-size, 4.4rem);
    min-height: var(--touch-target-size, 4.4rem);
    padding: var(--space-sm);
  }
  
  .checkbox--xs + .checkbox-custom,
  .checkbox--sm + .checkbox-custom,
  .checkbox--md + .checkbox-custom,
  .checkbox--lg + .checkbox-custom,
  .checkbox--xl + .checkbox-custom {
    min-width: var(--touch-target-size, 4.4rem);
    min-height: var(--touch-target-size, 4.4rem);
  }
}

/* ===== ACCESIBILIDAD ===== */
@media (prefers-reduced-motion: reduce) {
  .checkbox-custom,
  .checkbox-check,
  .checkbox-label,
  .checkbox-error {
    transition: none;
    animation: none;
  }
}

/* ===== ESTADOS INDETERMINATE POR VARIANTE ===== */
.checkbox--primary:indeterminate + .checkbox-custom {
  background-color: var(--color-primary);
  border-color: var(--color-primary);
}

.checkbox--secondary:indeterminate + .checkbox-custom {
  background-color: var(--color-secondary);
  border-color: var(--color-secondary);
}

.checkbox--success:indeterminate + .checkbox-custom {
  background-color: var(--color-success);
  border-color: var(--color-success);
}

.checkbox--warning:indeterminate + .checkbox-custom {
  background-color: var(--color-warning);
  border-color: var(--color-warning);
}

.checkbox--danger:indeterminate + .checkbox-custom {
  background-color: var(--color-danger);
  border-color: var(--color-danger);
}

.checkbox--neutral:indeterminate + .checkbox-custom {
  background-color: var(--color-neutral);
  border-color: var(--color-neutral);
}

.checkbox:indeterminate + .checkbox-custom .checkbox-check {
  opacity: 1;
  transform: scale(1);
}